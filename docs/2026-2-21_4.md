# 2026-02-21 进展记录（P1：revised paths 完成）

## 本次目标
- 承接 `2026-2-21.md` 与 `2026-2-21_3.md` 的下一步计划，完成 GAP-SUI-03：全局路径前缀 `::`（revised paths）支持。

## 主要改动

1. parser 支持 `::...` 起手路径
- `src/main/grammars/MoveParser.bnf`
  - `PathStart` 改为支持可选全局前缀：`('::')? ((PathAddress &'::') | PathIdent) TypeArgumentList?`
  - `Path_first` 增加 `'::'`
  - `Expr_first` 增加 `'::'`，保证表达式位置可从全局路径起手

2. parser 回归测试
- `src/test/kotlin/org/sui/lang/parser/CompleteParsingTest.kt`
  - 新增 `test revised paths`
- `src/test/resources/org/sui/lang/parser/complete/revised_paths.move`
- `src/test/resources/org/sui/lang/parser/complete/revised_paths.txt`
  - 覆盖 `use ::0x1::...`、`use ::std::...`、`use ::sui::...`
  - 覆盖表达式与类型中的全局路径（含 type args）

3. resolve 回归测试
- `src/test/kotlin/org/sui/lang/resolve/ResolveModulesTest.kt`
  - 新增 `test resolve module from global named address path`
  - 新增 `test resolve module from global value address path`

4. completion 回归测试
- `src/test/kotlin/org/sui/lang/completion/names/ModulesCompletionTest.kt`
  - 新增 `test autocomplete available modules for global value address`
  - 新增 `test no auto import for functions at item completion in global value address use speck`
- `src/test/kotlin/org/sui/lang/completion/names/project/ModulesCompletionProjectTest.kt`
  - 新增 `test complete module from global named address path`

5. 任务文档同步
- `docs/github-issues/sui-move-2024/03-revised-paths-global-prefix.md`
  - 任务项与 DoD 全部勾选完成

## 验证结果

执行命令：

```bash
./gradlew generateParser --no-daemon
./gradlew test --tests "org.sui.lang.parser.CompleteParsingTest" \
               --tests "org.sui.lang.resolve.ResolveModulesTest" \
               --tests "org.sui.lang.completion.names.ModulesCompletionTest" \
               --tests "org.sui.lang.completion.names.project.ModulesCompletionProjectTest" \
               --no-daemon
```

结果：
- `BUILD SUCCESSFUL`

## 当前结论
- GAP-SUI-03（revised paths）在 parser / resolve / completion 三条链路已闭环，`::std::...`、`::sui::...`、`::0x1::...` 场景可用并有回归保护。
